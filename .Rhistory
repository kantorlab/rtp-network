table(partner_db$NoReachWhy, exclude=NULL)
table(partner_db[id_unique_named_partners,]$ClientReached, exclude=NULL)
# How many sequenced persons cluster phylogenetically?
seq_pers_cluster_phylo <- nrow(genomic_db_sequenced_dt) - length(which(is.na(genomic_db_sequenced_dt$ClusteredPhyloAny)))
seq_pers_cluster_phylo
seq_pers_cluster_phylo/nrow(genomic_db_sequenced_dt)
# How many index cases (who appear in partner DB) and are sequenced are found to cluster phylogenetically?
seq_index_cases_nmd_pts <- which(genomic_db_sequenced_dt$StudyID %in% index_cases_who_named_partners)
seq_index_cases_nmd_pts_dt <- genomic_db_sequenced_dt[seq_index_cases_nmd_pts,]
ans1 <- nrow(seq_index_cases_nmd_pts_dt) -  length(which(is.na(seq_index_cases_nmd_pts_dt$ClusteredPhyloAny)))
ans1/nrow(seq_index_cases_nmd_pts_dt)
# How many named partners (who appear in partner DB) and are sequenced are found to cluster phylogenetically?
sequenced_who_are_named_pts <- (intersect(genomic_db_sequenced, partner_db$StudyIDTo))
sequenced_who_are_named_pts_id <- which(genomic_db_sequenced_dt$StudyID %in% sequenced_who_are_named_pts)
sequenced_who_are_named_pts_dt <- genomic_db_sequenced_dt[sequenced_who_are_named_pts_id,]
ans2 <- nrow(sequenced_who_are_named_pts_dt) -  length(which(is.na(sequenced_who_are_named_pts_dt$ClusteredPhyloAny)))
ans2/nrow(sequenced_who_are_named_pts_dt)
## Sequenced Index cases in Genomic DB
length(unique(genomic_db_sequenced_dt$StudyID))
compare_descriptives(dt=genomic_db_sequenced_dt)
## Sequenced Index cases who were interviewed in Partner DB
sequenced_and_interviewed <- intersect(genomic_db_sequenced, partner_db$StudyIDFrom)
sequenced_and_interviewed_idx <- which(genomic_db_sequenced_dt$StudyID %in% sequenced_and_interviewed)
sequenced_and_interviewed_db <- genomic_db_sequenced_dt[sequenced_and_interviewed_idx,]
dim(sequenced_and_interviewed_db)
table(sequenced_and_interviewed_db$DemoGender) #gender
table(sequenced_and_interviewed_db$DemoGender)/sum(table(sequenced_and_interviewed_db$DemoGender))
table(sequenced_and_interviewed_db$DemoRace) #race
table(sequenced_and_interviewed_db$DemoRace)/sum(table(sequenced_and_interviewed_db$DemoRace))
compare_descriptives(dt=sequenced_and_interviewed_db)
sequenced_and_named_pt_idx <- which(genomic_db_sequenced_dt$StudyID %in% index_cases_who_named_partners)
sequenced_and_named_pt_dt <- genomic_db_sequenced_dt[sequenced_and_named_pt_idx,]
dim(sequenced_and_named_pt_dt)
compare_descriptives(dt=sequenced_and_named_pt_dt)
## Named partners in the genomic DB
named_partners_in_genomic_dt <- genomic_db_sequenced_dt[id_named_partners_in_genomic_db,]
dim(named_partners_in_genomic_dt)
compare_descriptives(dt=named_partners_in_genomic_dt)
## row 1 - combined categories (all)
length(index_cases_who_named_partners) # row 1 - all
colnames(sequenced_and_interviewed_db$RiskPrimary)
table(sequenced_and_interviewed_db$RiskPrimary)
table(genomic_db$RiskPrimary)
table(genomic_db$RiskIDU)
table(genomic_db$RiskMSM)
table(genomic_db$RiskHeterosexual)
colnames(genomic_db)
table(genomic_db$ClusteredPhyloAny)
table(table(genomic_db$ClusteredPhyloAny))
(table(genomic_db$ClusteredPhyloAny, exclude = NULL))
length(which(!is.na(genomic_db$ClusteredPhyloAny)))
colnames(genomic_db)
colnames(partner_db)
table(partner_db$HIVTested, exclude = NULL)
table(partner_db$HIVTestResult_Final, exclude = NULL)
colnames(partner_db)
table(partner_db$ClientReached, exclude=NULL)
table(partner_db$NoReachWhy, exclude=NULL)
# How many sequenced persons cluster phylogenetically?
seq_pers_cluster_phylo <- nrow(genomic_db_sequenced_dt) - length(which(is.na(genomic_db_sequenced_dt$ClusteredPhyloAny)))
seq_pers_cluster_phylo/nrow(genomic_db_sequenced_dt)
# How many index cases (who appear in partner DB) and are sequenced are found to cluster phylogenetically?
seq_index_cases_nmd_pts <- which(genomic_db_sequenced_dt$StudyID %in% index_cases_who_named_partners)
seq_index_cases_nmd_pts_dt <- genomic_db_sequenced_dt[seq_index_cases_nmd_pts,]
ans1 <- nrow(seq_index_cases_nmd_pts_dt) -  length(which(is.na(seq_index_cases_nmd_pts_dt$ClusteredPhyloAny)))
ans1/nrow(seq_index_cases_nmd_pts_dt)
# sequenced
length(intersect(genomic_db_sequenced, partner_db$StudyIDTo))
length(Reduce(intersect, list(genomic_db_sequenced, partner_db$StudyIDFrom, partner_db$StudyIDTo)))
length(Reduce(intersect, list(genomic_db_sequenced, partner_db$StudyIDFrom, partner_db$StudyIDTo)))
# sequenced
length(intersect(genomic_db_sequenced, partner_db$StudyIDTo))
genomic_db_sequenced
genomic_db_sequenced(length())
length(genomic_db_sequenced)
# sequenced - MSM
genomic_db_sequenced_id %>%
filter(RiskMSM == "True")
# sequenced - MSM
genomic_db_sequenced %>%
filter(RiskMSM == "True")
genomic_db_sequenced
# sequenced - MSM
genomic_db %>%
filter(RiskMSM == "True")
# sequenced - MSM
genomic_db %>%
filter(Sequence=="True", RiskMSM == "True")
length(which(partner_db_non_missing_studyidto$StudyIDTo %in% genomic_db$StudyID))
length(which(partner_db$StudyIDTo %in% genomic_db$StudyID))
length(Reduce(intersect, list(genomic_db_sequenced, partner_db$StudyIDFrom, partner_db$StudyIDTo)))
# sequenced
length(intersect(genomic_db_sequenced, partner_db$StudyIDTo))
length(genomic_db_sequenced_id)
# sequenced - MSM
genomic_db_msm_sequenced_id <-
filter(Sequence == "True", RiskMSM == "TRUE") %>%
pull(StudyID)
# sequenced - MSM
genomic_db_msm_sequenced_id <-
filter(Sequenced == "True", RiskMSM == "TRUE") %>%
pull(StudyID)
# sequenced - MSM
genomic_db_msm_sequenced_id <-
genomic_db %>%
filter(Sequenced == "True", RiskMSM == "TRUE") %>%
pull(StudyID)
# sequenced - MSM
genomic_db_msm_sequenced_id <-
genomic_db %>%
filter(Sequence == "True", RiskMSM == "TRUE") %>%
pull(StudyID)
genomic_db_msm_sequenced_id
# sequenced - MSM
genomic_db_msm_sequenced_id <-
genomic_db %>%
filter(Sequence == "True", RiskMSM == "TRUE")
dim(genomic_db_msm_sequenced_id)
colnames(genomic_db)
# sequenced - MSM
genomic_db_msm_sequenced_id <-
genomic_db %>%
filter(Sequence == "True" & RiskMSM == "TRUE")
table(genomic_db_msm_sequenced_id)
genomic_db %>%
filter(Sequence == "True" & RiskMSM == "TRUE")
# sequenced - MSM
genomic_db_msm_sequenced_id <-
genomic_db %>%
filter(Sequence == TRUE & RiskMSM == TRUE)
genomic_db_msm_sequenced_id
glimpse(genomic_db)
# sequenced - MSM
genomic_db_msm_sequenced_id <-
genomic_db %>%
filter(Sequence == "True" & RiskMSM == "True")
genomic_db_msm_sequenced_id
# sequenced - MSM
genomic_db_msm_sequenced_id <-
genomic_db %>%
filter(Sequence == "True" & RiskMSM == "True") %>%
pull(StudyID)
genomic_db_msm_sequenced_id
length(unique(genomic_db_msm_sequenced_id))
length(genomic_db_msm_sequenced_id)
# sequenced - MSM
length(genomic_db_sequenced_dt$RiskMSM == "True")
length(genomic_db_msm_sequenced_id)
length(unique(genomic_db_msm_sequenced_id))
glimpse(partner_db)
genomic_db_msm_sequenced_id %in% partner_db$StudyIDTo
sum(genomic_db_msm_sequenced_id %in% partner_db$StudyIDTo)
# sequenced - MSM
genomic_db_msm <-
genomic_db %>%
filter(RiskMSM == "True") %>%
pull(StudyID)
genomic_db_msm_sequenced_id <-
genomic_db %>%
filter(Sequence == "True" & RiskMSM == "True") %>%
pull(StudyID)
length(genomic_db_msm)
length(unique(genomic_db_msm))
length(genomic_db_msm_sequenced_id)
length(unique(genomic_db_msm_sequenced_id))
sum(genomic_db_msm_sequenced_id %in% partner_db$StudyIDTo)
sum(genomic_db_msm %in% partner_db$StudyIDTo)
# sequenced - MSM
genomic_db_msm <-
genomic_db %>%
filter(RiskMSM == "True") %>%
pull(StudyID)
length(genomic_db_msm)
length(unique(genomic_db_msm))
sum(genomic_db_msm %in% partner_db$StudyIDTo)
genomic_db_msm_sequenced_id <-
genomic_db %>%
filter(Sequence == "True" & RiskMSM == "True") %>%
pull(StudyID)
length(genomic_db_msm_sequenced_id)
length(unique(genomic_db_msm_sequenced_id))
sum(genomic_db_msm_sequenced_id %in% partner_db$StudyIDTo)
sum(genomic_db_msm_sequenced_id %in% c(partner_db$StudyIDTo, partner_db$StudyIDFrom))
sum(genomic_db_msm_sequenced_id %in%
unique(c(partner_db$StudyIDTo, partner_db$StudyIDFrom)))
colnames(partner_db)
(partner_db$RiskIdentified)
table(partner_db$RiskIdentified, exclude = NULL)
length(named_partners_tested_studyidto)
individuals_dt_of_msm_who_named_partners <-
individuals_dt[StudyID %in% IPs_reporting_partners_in_unified_dt & RiskMSM == "True",,]
individuals_dt_of_msm_who_named_partners <-
genomic_db[StudyID %in% IPs_reporting_partners_in_unified_dt & RiskMSM == "True",,]
length(index_cases_who_named_partners)
individuals_dt_of_msm_who_named_partners <-
genomic_db[StudyID %in% index_cases_who_named_partners & RiskMSM == "True",,]
nrow(individuals_dt_of_msm_who_named_partners)
msm_in_genomic_db_who_named_partners <-
genomic_db[StudyID %in% index_cases_who_named_partners & RiskMSM == "True",,]
nrow(msm_in_genomic_db_who_named_partners)
sum(genomic_db_msm_sequenced_id %in%
unique(c(partner_db$StudyIDTo, partner_db$StudyIDFrom)))
length(which(partner_db$StudyIDTo %in% genomic_db$StudyID))
length(which(partner_db_non_missing_studyidto$StudyIDTo %in% genomic_db$StudyID))
msm_in_genomic_db_who_named_partners <-
genomic_db[StudyID %in% index_cases_who_named_partners & RiskMSM == "True",,]
nrow(msm_in_genomic_db_who_named_partners)
net_dt_of_msm_who_named_partners <- net_dt[StudyIDFrom %in% individuals_dt_of_msm_who_named_partners$StudyID,,]
partner_db[StudyIDFrom %in% msm_in_genomic_db_who_named_partners$StudyID,,]
dim(partner_db_of_msm_who_named_partners)
partner_db_of_msm_who_named_partners <-
partner_db[StudyIDFrom %in% msm_in_genomic_db_who_named_partners$StudyID,,]
dim(partner_db_of_msm_who_named_partners)
unique(partner_db_of_msm_who_named_partners$StudyIDFrom)
length(unique(partner_db_of_msm_who_named_partners$StudyIDFrom))
length(unique(partner_db_of_msm_who_named_partners$StudyIDTo))
table(partner_db_of_msm_who_named_partners$HIVTested, exclude = NULL)
msm_reported_partners_in_individuals_dt <-
intersect(genomic_db$StudyID, partner_db_of_msm_who_named_partners$StudyIDTo)
msm_reported_partners_in_individuals_dt
dim(msm_reported_partners_in_individuals_dt)
genomic_db$StudyID %in% msm_reported_partners_in_individuals_dt
which(genomic_db$StudyID %in% msm_reported_partners_in_individuals_dt)
genomic_db[which(genomic_db$StudyID %in% msm_reported_partners_in_individuals_dt)]
genomic_db[which(genomic_db$StudyID %in% msm_reported_partners_in_individuals_dt),]
genomic_db[which(genomic_db$StudyID %in% msm_reported_partners_in_individuals_dt),]$Sequence
table(genomic_db[which(genomic_db$StudyID %in% msm_reported_partners_in_individuals_dt),]$Sequence, exclude = NULL)
colnames(genomic_db)
table(genomic_db[which(genomic_db$StudyID %in% msm_reported_partners_in_individuals_dt),]$HIVDxDate, exclude = NULL)
sum(table(genomic_db[which(genomic_db$StudyID %in% msm_reported_partners_in_individuals_dt),]$HIVDxDate, exclude = NULL))
table(genomic_db[which(genomic_db$StudyID %in% msm_reported_partners_in_individuals_dt),]$Sequence, exclude = NULL)
## msm breakdown
msm_in_genomic_db_who_named_partners <-
genomic_db[StudyID %in% index_cases_who_named_partners & RiskMSM == "True",,]
nrow(msm_in_genomic_db_who_named_partners)
partner_db_of_msm_who_named_partners <-
partner_db[StudyIDFrom %in% msm_in_genomic_db_who_named_partners$StudyID,,]
dim(partner_db_of_msm_who_named_partners)
length(unique(partner_db_of_msm_who_named_partners$StudyIDFrom))
length(unique(partner_db_of_msm_who_named_partners$StudyIDTo))
table(partner_db_of_msm_who_named_partners$HIVTested, exclude = NULL)
msm_reported_partners_in_individuals_dt <-
intersect(genomic_db$StudyID, partner_db_of_msm_who_named_partners$StudyIDTo)
sum(table(genomic_db[which(genomic_db$StudyID %in% msm_reported_partners_in_individuals_dt),]$HIVDxDate, exclude = NULL))
table(genomic_db[which(genomic_db$StudyID %in% msm_reported_partners_in_individuals_dt),]$Sequence, exclude = NULL)
# sequenced
length(intersect(genomic_db_sequenced, partner_db$StudyIDTo))
length(Reduce(intersect, list(genomic_db_sequenced, partner_db$StudyIDFrom, partner_db$StudyIDTo)))
length(which(partner_db$StudyIDTo %in% genomic_db$StudyID))
length(which(partner_db_non_missing_studyidto$StudyIDTo %in% genomic_db$StudyID))
# sequenced - MSM
genomic_db_msm <-
genomic_db %>%
filter(RiskMSM == "True") %>%
pull(StudyID)
length(genomic_db_msm)
length(unique(genomic_db_msm))
sum(genomic_db_msm %in% partner_db$StudyIDTo)
genomic_db_msm_sequenced_id <-
genomic_db %>%
filter(Sequence == "True" & RiskMSM == "True") %>%
pull(StudyID)
length(genomic_db_msm_sequenced_id)
length(unique(genomic_db_msm_sequenced_id))
sum(genomic_db_msm_sequenced_id %in% partner_db$StudyIDTo)
sum(genomic_db_msm_sequenced_id %in%
unique(c(partner_db$StudyIDTo, partner_db$StudyIDFrom)))
source("~/code/rtp-network/data-breakdown.R", echo=TRUE)
## row 1 - combined categories (all)
length(index_cases_who_named_partners) # row 1 - all
length(unique(partner_db_non_missing_studyidto$StudyIDTo))
table(partner_db_non_missing_studyidto$ClientReached, exclude = NULL)
named_partners_tested_countstudyidfrom <-
partner_db %>%
filter(HIVTested == 1) %>%
pull(StudyIDFrom) %>%
unique()
length(named_partners_tested_countstudyidfrom)
named_partners_tested_studyidto <-
partner_db %>%
filter(HIVTested == 1) %>%
pull(StudyIDTo) %>%
unique()
length(named_partners_tested_studyidto)
length(named_partners_tested_studyidto)
# How many total partners are named by the index cases in the genomic DB who named partners?
length(unique(partner_db_non_missing_studyidto$StudyIDTo))
partner_db_non_missing_studyidto$StudyIDTo
unique_named_pt_contacts_reported_by_IPs <-
partner_db_non_missing_studyidto$StudyIDTo
length(which(unique_named_pt_contacts_reported_by_IPs %in%
genomic_db$StudyID))
length(which(unique_named_pt_contacts_reported_by_IPs %in%
genomic_db_sequenced_dt$StudyID))
genomic_db_sequenced_dt
unique_named_pt_contacts_reported_by_IPs <-
partner_db_non_missing_studyidto$StudyIDTo
length(which(unique_named_pt_contacts_reported_by_IPs %in%
genomic_db_sequenced_dt$StudyID))
length(which(unique_named_pt_contacts_reported_by_IPs %in%
genomic_db_sequenced_dt$StudyID))
named_contacts_in_unified_dataset <-
unique_named_pt_contacts_reported_by_IPs[which(unique_named_pt_contacts_reported_by_IPs %in%
individuals_dt$StudyID)]
named_contacts_in_unified_dataset <-
unique_named_pt_contacts_reported_by_IPs[which(unique_named_pt_contacts_reported_by_IPs %in%
genomic_db_sequenced_dt$StudyID)]
length(named_contacts_in_unified_dataset) # number of reported partners in genomic database
named_contacts_rows_from_unified_dt <- genomic_db_sequenced_dt[StudyID %in% named_contacts_in_unified_dataset,,]
dim(named_contacts_rows_from_unified_dt)
dim(named_contacts_rows_from_unified_dt)
dim(named_contacts_rows_from_unified_dt)
table(substr(named_contacts_rows_from_unified_dt$HIVDxDate, 1, 4), exclude = NULL)
length(named_contacts_rows_from_unified_dt$HIVDxDate)
length(which(named_contacts_rows_from_unified_dt$HIVDxDate == ""))
table(individuals_dt[StudyID %in% named_contacts_in_unified_dataset,,]$HIVDxDate, exclude = NULL)
table(genomic_db_sequenced_dt[StudyID %in% named_contacts_in_unified_dataset,,]$HIVDxDate, exclude = NULL)
## row 1 - combined categories (all)
length(index_cases_who_named_part
ners) # row 1 - all
## row 1 - combined categories (all)
length(index_cases_who_named_partners) # row 1 - all
length(unique(partner_db_non_missing_studyidto$StudyIDTo))
table(partner_db_non_missing_studyidto$ClientReached, exclude = NULL)
named_partners_tested_countstudyidfrom <-
partner_db %>%
filter(HIVTested == 1) %>%
pull(StudyIDFrom) %>%
unique()
length(named_partners_tested_countstudyidfrom)
named_partners_tested_studyidto <-
partner_db %>%
filter(HIVTested == 1) %>%
pull(StudyIDTo) %>%
unique()
length(named_partners_tested_studyidto)
unique_named_pt_contacts_reported_by_IPs <-
partner_db_non_missing_studyidto$StudyIDTo
length(which(unique_named_pt_contacts_reported_by_IPs %in%
genomic_db_sequenced_dt$StudyID))
unique_named_pt_contacts_reported_by_IPs
length(which(unique_named_pt_contacts_reported_by_IPs %in%
genomic_db_sequenced_dt$StudyID))
named_contacts_in_unified_dataset <-
unique_named_pt_contacts_reported_by_IPs[which(unique_named_pt_contacts_reported_by_IPs %in%
genomic_db_sequenced_dt$StudyID)]
named_contacts_in_unified_dataset <-
unique_named_pt_contacts_reported_by_IPs[which(unique_named_pt_contacts_reported_by_IPs %in%
genomic_db_sequenced_dt$StudyID)]
length(named_contacts_in_unified_dataset) # number of reported partners in genomic database
named_contacts_rows_from_unified_dt <- genomic_db_sequenced_dt[StudyID %in%
named_contacts_in_unified_dataset,,]
dim(named_contacts_rows_from_unified_dt)
table(substr(named_contacts_rows_from_unified_dt$HIVDxDate, 1, 4), exclude = NULL)
named_contacts_rows_from_unified_dt <-
genomic_db_sequenced_dt[StudyID %in% named_contacts_in_unified_dataset,,]
length(named_contacts_in_unified_dataset) # number of reported partners in genomic database
named_contacts_rows_from_unified_dt <-
genomic_db_sequenced_dt[StudyID %in% named_contacts_in_unified_dataset,,]
named_contacts_in_genomic_dataset <-
unique_named_pt_contacts_reported_by_IPs[which(unique_named_pt_contacts_reported_by_IPs %in%
genomic_db_sequenced_dt$StudyID)]
length(named_contacts_in_genomic_dataset) # number of reported partners in genomic database
named_contacts_rows_from_genomic_dt <-
genomic_db_sequenced_dt[StudyID %in% named_contacts_in_genomic_dataset,,]
dim(named_contacts_rows_from_genomic_dt)
table(substr(named_contacts_rows_from_genomic_dt$HIVDxDate, 1, 4), exclude = NULL)
length(named_contacts_rows_from_genomic_dt$HIVDxDate)
length(which(named_contacts_rows_from_genomic_dt$HIVDxDate == ""))
table(genomic_db_sequenced_dt[StudyID %in%
named_contacts_in_genomic_dataset,,]$HIVDxDate, exclude = NULL)
length(named_contacts_in_genomic_dataset) # number of reported partners in genomic database
length(which(unique_named_pt_contacts_reported_by_IPs %in%
genomic_db_sequenced_dt$StudyID))
length(which(unique_named_pt_contacts_reported_by_IPs %in%
genomic_db_sequenced_dt$StudyID))
which(unique_named_pt_contacts_reported_by_IPs %in%
genomic_db_sequenced_dt$StudyID)
unique_named_pt_contacts_reported_by_IPs[which(unique_named_pt_contacts_reported_by_IPs %in%
genomic_db_sequenced_dt$StudyID)]
unique(unique_named_pt_contacts_reported_by_IPs[which(unique_named_pt_contacts_reported_by_IPs %in%
genomic_db_sequenced_dt$StudyID)])
table(substr(named_contacts_rows_from_genomic_dt$HIVDxDate, 1, 4), exclude = NULL)
length(named_contacts_rows_from_genomic_dt$HIVDxDate)
length(which(named_contacts_rows_from_genomic_dt$HIVDxDate == ""))
table(genomic_db_sequenced_dt[StudyID %in%
named_contacts_in_genomic_dataset,,]$HIVDxDate, exclude = NULL)
# sequenced
length(intersect(genomic_db_sequenced, partner_db$StudyIDTo))
length(Reduce(intersect, list(genomic_db_sequenced, partner_db$StudyIDFrom, partner_db$StudyIDTo)))
length(which(partner_db$StudyIDTo %in% genomic_db$StudyID))
length(which(partner_db_non_missing_studyidto$StudyIDTo %in% genomic_db$StudyID))
length(intersect(genomic_db_sequenced, partner_db$StudyIDTo))
length(Reduce(intersect, list(genomic_db_sequenced, partner_db$StudyIDFrom, partner_db$StudyIDTo)))
length(Reduce(intersect, list(genomic_db_sequenced, partner_db$StudyIDFrom, partner_db$StudyIDTo)))
length(which(partner_db$StudyIDTo %in% genomic_db_sequenced_dt$StudyID))
length(which(partner_db_non_missing_studyidto$StudyIDTo %in% genomic_db$StudyID))
## msm breakdown
msm_in_genomic_db_who_named_partners <-
genomic_db[StudyID %in% index_cases_who_named_partners & RiskMSM == "True",,]
nrow(msm_in_genomic_db_who_named_partners)
partner_db_of_msm_who_named_partners <-
partner_db[StudyIDFrom %in% msm_in_genomic_db_who_named_partners$StudyID,,]
dim(partner_db_of_msm_who_named_partners)
length(unique(partner_db_of_msm_who_named_partners$StudyIDFrom))
length(unique(partner_db_of_msm_who_named_partners$StudyIDTo))
table(partner_db_of_msm_who_named_partners$HIVTested, exclude = NULL)
table(genomic_db_sequenced_dt[StudyID %in%
named_contacts_in_genomic_dataset,,]$HIVDxDate, exclude = NULL)
table(substr(named_contacts_rows_from_genomic_dt$HIVDxDate, 1, 4), exclude = NULL)
sum(table(substr(named_contacts_rows_from_genomic_dt$HIVDxDate, 1, 4), exclude = NULL))
sum(table(substr(named_contacts_rows_from_genomic_dt$HIVDxDate, 1, 4), exclude = NULL))
length(named_contacts_rows_from_genomic_dt$HIVDxDate)
length(which(named_contacts_rows_from_genomic_dt$HIVDxDate == ""))
table(genomic_db_sequenced_dt[StudyID %in%
named_contacts_in_genomic_dataset,,]$HIVDxDate, exclude = NULL)
length(intersect(genomic_db_sequenced, partner_db$StudyIDTo))
length(Reduce(intersect, list(genomic_db_sequenced, partner_db$StudyIDFrom, partner_db$StudyIDTo)))
length(Reduce(intersect, list(genomic_db_sequenced, partner_db$StudyIDFrom,
partner_db$StudyIDTo)))
colnames(named_contacts_rows_from_genomic_dt)
length(named_contacts_rows_from_genomic_dt$HIVDxDate)
length(which(named_contacts_rows_from_genomic_dt$HIVDxDate == ""))
table(genomic_db_sequenced_dt[StudyID %in%
named_contacts_in_genomic_dataset,,]$HIVDxDate, exclude = NULL)
table(genomic_db_sequenced_dt[StudyID %in%
named_contacts_in_genomic_dataset,,]$HIVDxDate, exclude = NULL)
colnames(named_contacts_in_genomic_dataset)
colnames(genomic_db_sequenced_dt)
table(genomic_db_sequenced_dt[StudyID %in%
named_contacts_in_genomic_dataset,,]$Sequence, exclude = NULL)
length(intersect(genomic_db_sequenced, partner_db$StudyIDTo))
length(Reduce(intersect, list(genomic_db_sequenced, partner_db$StudyIDFrom,
partner_db$StudyIDTo)))
## msm breakdown
msm_in_genomic_db_who_named_partners <-
genomic_db[StudyID %in% index_cases_who_named_partners & RiskMSM == "True",,]
nrow(msm_in_genomic_db_who_named_partners)
partner_db_of_msm_who_named_partners <-
partner_db[StudyIDFrom %in% msm_in_genomic_db_who_named_partners$StudyID,,]
dim(partner_db_of_msm_who_named_partners)
length(unique(partner_db_of_msm_who_named_partners$StudyIDFrom))
length(unique(partner_db_of_msm_who_named_partners$StudyIDTo))
table(partner_db_of_msm_who_named_partners$HIVTested, exclude = NULL)
msm_reported_partners_in_individuals_dt <-
intersect(genomic_db$StudyID, partner_db_of_msm_who_named_partners$StudyIDTo)
msm_reported_partners_in_individuals_dt
sum(table(genomic_db[which(genomic_db$StudyID %in% msm_reported_partners_in_individuals_dt),]$HIVDxDate, exclude = NULL))
table(genomic_db[which(genomic_db$StudyID %in% msm_reported_partners_in_individuals_dt),]$Sequence, exclude = NULL)
msm_reported_partners_in_individuals_dt <-
intersect(genomic_db_sequenced_dt$StudyID, partner_db_of_msm_who_named_partners$StudyIDTo)
sum(table(genomic_db[which(genomic_db$StudyID %in% msm_reported_partners_in_individuals_dt),]$HIVDxDate, exclude = NULL))
sum(table(genomic_db[which(genomic_db_sequenced_dts$StudyID %in% msm_reported_partners_in_individuals_dt),]$HIVDxDate, exclude = NULL))
sum(table(genomic_db[which(genomic_db_sequenced_dt$StudyID %in%
msm_reported_partners_in_individuals_dt),]$HIVDxDate, exclude = NULL))
table(genomic_db[which(genomic_db$StudyID %in% msm_reported_partners_in_individuals_dt),]$Sequence, exclude = NULL)
# sequenced - MSM
genomic_db_msm <-
genomic_db %>%
filter(RiskMSM == "True") %>%
pull(StudyID)
length(genomic_db_msm)
length(unique(genomic_db_msm))
sum(genomic_db_msm %in% partner_db$StudyIDTo)
genomic_db_msm_sequenced_id <-
genomic_db %>%
filter(Sequence == "True" & RiskMSM == "True") %>%
pull(StudyID)
length(genomic_db_msm_sequenced_id)
length(unique(genomic_db_msm_sequenced_id))
sum(genomic_db_msm_sequenced_id %in% partner_db$StudyIDTo)
sum(genomic_db_msm_sequenced_id %in%
unique(c(partner_db$StudyIDTo, partner_db$StudyIDFrom)))
## idu breakdown
idu_in_genomic_db_who_named_partners <-
genomic_db[StudyID %in% index_cases_who_named_partners & Riskidu == "True",,]
## idu breakdown
idu_in_genomic_db_who_named_partners <-
genomic_db[StudyID %in% index_cases_who_named_partners & RiskIDU == "True",,]
nrow(idu_in_genomic_db_who_named_partners)
partner_db_of_idu_who_named_partners <-
partner_db[StudyIDFrom %in% idu_in_genomic_db_who_named_partners$StudyID,,]
dim(partner_db_of_idu_who_named_partners)
length(unique(partner_db_of_idu_who_named_partners$StudyIDFrom))
length(unique(partner_db_of_idu_who_named_partners$StudyIDTo))
table(partner_db_of_idu_who_named_partners$HIVTested, exclude = NULL)
idu_reported_partners_in_individuals_dt <-
intersect(genomic_db_sequenced_dt$StudyID, partner_db_of_idu_who_named_partners$StudyIDTo)
sum(table(genomic_db[which(genomic_db_sequenced_dt$StudyID %in%
idu_reported_partners_in_individuals_dt),]$HIVDxDate, exclude = NULL))
table(genomic_db[which(genomic_db$StudyID %in% idu_reported_partners_in_individuals_dt),]$Sequence, exclude = NULL)
## hrh breakdown
hrh_in_genomic_db_who_named_partners <-
genomic_db[StudyID %in% index_cases_who_named_partners & Riskhrh == "True",,]
## hrh breakdown
hrh_in_genomic_db_who_named_partners <-
genomic_db[StudyID %in% index_cases_who_named_partners & RiskHRH == "True",,]
## hrh breakdown
hrh_in_genomic_db_who_named_partners <-
genomic_db[StudyID %in% index_cases_who_named_partners & RiskHeterosexual == "True",,]
nrow(hrh_in_genomic_db_who_named_partners)
partner_db_of_hrh_who_named_partners <-
partner_db[StudyIDFrom %in% hrh_in_genomic_db_who_named_partners$StudyID,,]
dim(partner_db_of_hrh_who_named_partners)
length(unique(partner_db_of_hrh_who_named_partners$StudyIDFrom))
length(unique(partner_db_of_hrh_who_named_partners$StudyIDTo))
table(partner_db_of_hrh_who_named_partners$HIVTested, exclude = NULL)
hrh_reported_partners_in_indivhrhals_dt <-
intersect(genomic_db_sequenced_dt$StudyID, partner_db_of_hrh_who_named_partners$StudyIDTo)
sum(table(genomic_db[which(genomic_db_sequenced_dt$StudyID %in%
hrh_reported_partners_in_indivhrhals_dt),]$HIVDxDate, exclude = NULL))
table(genomic_db[which(genomic_db$StudyID %in% hrh_reported_partners_in_indivhrhals_dt),]$Sequence, exclude = NULL)
